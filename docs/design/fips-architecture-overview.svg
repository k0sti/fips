<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 420" font-family="monospace" font-size="13">
  <style>
    rect.node { fill: #1a1a2e; stroke: #e0e0e0; stroke-width: 1.5; rx: 4; }
    rect.app  { fill: #2a2a4e; stroke: #e0e0e0; stroke-width: 1; rx: 2; }
    rect.fips { fill: #2e3a5e; stroke: #e0e0e0; stroke-width: 1; rx: 2; }
    rect.xport { fill: #3a2e2e; stroke: #e0e0e0; stroke-width: 1; rx: 2; }
    text { fill: #e0e0e0; }
    text.label { font-size: 14px; font-weight: bold; }
    text.npub { font-size: 11px; fill: #90a0b0; }
    text.role { font-size: 11px; fill: #90a0b0; }
    text.layer { font-size: 12px; }
    text.transport-label { font-size: 11px; fill: #c0c0c0; }
    line.link { stroke: #70a0d0; stroke-width: 2; }
    line.session { stroke: #d0a040; stroke-width: 2; stroke-dasharray: 6,3; }
    text.link-label { font-size: 11px; fill: #70a0d0; }
    text.session-label { font-size: 12px; fill: #d0a040; }
  </style>

  <!-- Background -->
  <rect width="900" height="420" fill="#0d1117" rx="8"/>

  <!-- Node positions: x = 60, 230, 400, 570, 740  width=100 -->

  <!-- Node A -->
  <text x="110" y="30" text-anchor="middle" class="label">Node A</text>
  <text x="110" y="46" text-anchor="middle" class="npub">npub1aaa...</text>
  <text x="110" y="60" text-anchor="middle" class="role">(source)</text>
  <rect x="60" y="70" width="100" height="130" class="node"/>
  <rect x="70" y="80" width="80" height="30" class="app"/>
  <text x="110" y="100" text-anchor="middle" class="layer">App</text>
  <rect x="70" y="118" width="80" height="30" class="fips"/>
  <text x="110" y="138" text-anchor="middle" class="layer">FIPS</text>
  <rect x="70" y="156" width="80" height="30" class="xport"/>
  <text x="110" y="176" text-anchor="middle" class="layer">WiFi</text>

  <!-- Node B -->
  <text x="280" y="30" text-anchor="middle" class="label">Node B</text>
  <text x="280" y="46" text-anchor="middle" class="npub">npub1bbb...</text>
  <text x="280" y="60" text-anchor="middle" class="role">(relay)</text>
  <rect x="230" y="70" width="100" height="130" class="node"/>
  <rect x="240" y="118" width="80" height="30" class="fips"/>
  <text x="280" y="138" text-anchor="middle" class="layer">FIPS</text>
  <rect x="240" y="156" width="37" height="30" class="xport"/>
  <text x="258" y="176" text-anchor="middle" class="layer">WiFi</text>
  <rect x="283" y="156" width="37" height="30" class="xport"/>
  <text x="302" y="176" text-anchor="middle" class="layer">Eth</text>

  <!-- Node C -->
  <text x="450" y="30" text-anchor="middle" class="label">Node C</text>
  <text x="450" y="46" text-anchor="middle" class="npub">npub1ccc...</text>
  <text x="450" y="60" text-anchor="middle" class="role">(relay)</text>
  <rect x="400" y="70" width="100" height="130" class="node"/>
  <rect x="410" y="118" width="80" height="30" class="fips"/>
  <text x="450" y="138" text-anchor="middle" class="layer">FIPS</text>
  <rect x="410" y="156" width="37" height="30" class="xport"/>
  <text x="428" y="176" text-anchor="middle" class="layer">Eth</text>
  <rect x="453" y="156" width="37" height="30" class="xport"/>
  <text x="472" y="176" text-anchor="middle" class="layer">UDP</text>

  <!-- Node D -->
  <text x="620" y="30" text-anchor="middle" class="label">Node D</text>
  <text x="620" y="46" text-anchor="middle" class="npub">npub1ddd...</text>
  <text x="620" y="60" text-anchor="middle" class="role">(relay)</text>
  <rect x="570" y="70" width="100" height="130" class="node"/>
  <rect x="580" y="118" width="80" height="30" class="fips"/>
  <text x="620" y="138" text-anchor="middle" class="layer">FIPS</text>
  <rect x="580" y="156" width="37" height="30" class="xport"/>
  <text x="598" y="176" text-anchor="middle" class="layer">UDP</text>
  <rect x="623" y="156" width="37" height="30" class="xport"/>
  <text x="642" y="176" text-anchor="middle" class="layer">Tor</text>

  <!-- Node E -->
  <text x="790" y="30" text-anchor="middle" class="label">Node E</text>
  <text x="790" y="46" text-anchor="middle" class="npub">npub1eee...</text>
  <text x="790" y="60" text-anchor="middle" class="role">(dest)</text>
  <rect x="740" y="70" width="100" height="130" class="node"/>
  <rect x="750" y="80" width="80" height="30" class="app"/>
  <text x="790" y="100" text-anchor="middle" class="layer">App</text>
  <rect x="750" y="118" width="80" height="30" class="fips"/>
  <text x="790" y="138" text-anchor="middle" class="layer">FIPS</text>
  <rect x="750" y="156" width="80" height="30" class="xport"/>
  <text x="790" y="176" text-anchor="middle" class="layer">Tor</text>

  <!-- Link lines (from bottom of transport boxes) -->
  <!-- WiFi: A(110) -> B-WiFi(258) -->
  <line x1="110" y1="200" x2="110" y2="240" class="link"/>
  <line x1="110" y1="240" x2="258" y2="240" class="link"/>
  <line x1="258" y1="240" x2="258" y2="200" class="link"/>
  <text x="184" y="256" text-anchor="middle" class="link-label">WiFi</text>

  <!-- Ethernet: B-Eth(302) -> C-Eth(428) -->
  <line x1="302" y1="200" x2="302" y2="270" class="link"/>
  <line x1="302" y1="270" x2="428" y2="270" class="link"/>
  <line x1="428" y1="270" x2="428" y2="200" class="link"/>
  <text x="365" y="286" text-anchor="middle" class="link-label">Ethernet</text>

  <!-- UDP/IP: C-UDP(472) -> D-UDP(598) -->
  <line x1="472" y1="200" x2="472" y2="300" class="link"/>
  <line x1="472" y1="300" x2="598" y2="300" class="link"/>
  <line x1="598" y1="300" x2="598" y2="200" class="link"/>
  <text x="535" y="316" text-anchor="middle" class="link-label">UDP/IP</text>

  <!-- Tor: D-Tor(642) -> E(790) -->
  <line x1="642" y1="200" x2="642" y2="330" class="link"/>
  <line x1="642" y1="330" x2="790" y2="330" class="link"/>
  <line x1="790" y1="330" x2="790" y2="200" class="link"/>
  <text x="716" y="346" text-anchor="middle" class="link-label">Tor</text>

  <!-- End-to-end session (dashed) -->
  <line x1="110" y1="380" x2="790" y2="380" class="session"/>
  <text x="450" y="375" text-anchor="middle" class="session-label">End-to-end encrypted session (A â†” E)</text>

  <!-- Link labels -->
  <text x="184" y="405" text-anchor="middle" class="link-label">Link</text>
  <line x1="110" y1="395" x2="258" y2="395" class="link" stroke-dasharray="3,2"/>
  <text x="365" y="405" text-anchor="middle" class="link-label">Link</text>
  <line x1="302" y1="395" x2="428" y2="395" class="link" stroke-dasharray="3,2"/>
  <text x="535" y="405" text-anchor="middle" class="link-label">Link</text>
  <line x1="472" y1="395" x2="598" y2="395" class="link" stroke-dasharray="3,2"/>
  <text x="716" y="405" text-anchor="middle" class="link-label">Link</text>
  <line x1="642" y1="395" x2="790" y2="395" class="link" stroke-dasharray="3,2"/>
</svg>
