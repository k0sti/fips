# Cost-Based Parent Selection: Deeper Fiber Beats Shallow LoRa
#
# Topology (explicit 4-node):
#
#    n01 (root)
#    /       \
#   fiber    LoRa
#   /         \
#  n02        n04  (test subject)
#   |        /
#  fiber   fiber
#   |    /
#  n03
#
# n04 has two candidate parents:
#   - n01 (root, depth 0) via LoRa:  effective_depth = 0 + ~6.0 = ~6.0
#   - n03 (depth 2) via fiber:       effective_depth = 2 + ~1.01 = ~3.01
#
# Without cost-based selection, n04 would pick n01 (depth 0 < depth 2).
# With cost-based selection, n04 should pick n03 (lower effective_depth
# despite being 2 levels deeper).
#
# This tests the core depth-vs-cost tradeoff: a much deeper fiber path
# should beat a direct LoRa link to root when the cost difference is
# large enough.
#
# Validation: tree snapshot shows n04's parent is n03, n04's depth is 3.

scenario:
  name: "depth-vs-cost"
  seed: 42
  duration_secs: 120

topology:
  algorithm: explicit
  num_nodes: 4
  params:
    adjacency:
      - [n01, n02]
      - [n02, n03]
      - [n03, n04]
      - [n01, n04]
  subnet: "172.20.0.0/24"
  ip_start: 10

netem:
  enabled: true
  default_policy:
    # Fiber-like
    delay_ms: [1, 5]
    jitter_ms: [0, 1]
    loss_pct: [0, 0.5]
  link_policies:
    # LoRa link from n01 to n04
    - edges: ["n01-n04"]
      policy:
        delay_ms: [400, 600]
        jitter_ms: [50, 100]
        loss_pct: [5, 15]

link_flaps:
  enabled: false

traffic:
  enabled: true
  max_concurrent: 1
  interval_secs: {min: 15, max: 30}
  duration_secs: {min: 5, max: 10}
  parallel_streams: 2

logging:
  rust_log: "info"
  output_dir: "./sim-results"
